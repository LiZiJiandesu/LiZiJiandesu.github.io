[{"title":"广西移动光猫折腾日记（上）：翻车忏悔录","url":"/广西移动光猫折腾日记（上）：翻车忏悔录/","content":"## 一、前因\n家里只有一条移动送的50M宽带，附带送了IPTV服务。\n而我家里只有我姐可能需要稍微上网刷一下微信、听听歌。我家地位最低的侄子（在上中学）甚至被严格控制使用网络时间。所以家里人对网络的需求极小，没有专门去购买路由器。\n在我寒假放假回来~~宅家~~的时候才发现，家里的网络状况有多么的糟糕……\n首先，移动送的光猫既当光猫又当路由，而光猫那孱弱的性能根本不足以同时完成这两项工作，这就导致了偶尔在流量多时造成严重的延迟。\n并且在广西，冬天白天气温可达20°C+，加上光猫自身满载的发热量，时不时还会自动重启。\n我甚至连在线视频都不敢看。看视频看到高潮突然被掐断的感觉，就好像你想打个嗝的时候突然有个人往你的嘴里塞了一块面包被强行摁下去一样。\n终于在某一个晚上，怒不可遏的我进入了光猫的后台。于是就有了下面的故事。\n\n## 二、作死\n光猫型号是华为的HS8545M5，固件用的是移动定制的固件。\n光猫贴纸上只给了user用户来进入后台，这个用户的权限非常的低，关键的设置项基本上只能看，不能修改，想要进行高级操作必须拿到超级账户。\n大部分地区的移动都是采用同一个超级账户名和密码，但是广西偏要特立独行，弄了一个自己的超级账户和密码，分别为：\n```\nadmin          #用户名\nCmcc10086#     #密码\n```\n进入后台，我们能看到很多眼花缭乱的选项，有很多在路由器上根本没见过，让我这个小白无所适从，不得不一直翻恩山论坛进行学习。\n其中一些帖子提到，网络连接中有一条名叫“TR069”的连接，这条连接是移动专门拿来控制光猫的通道，甚至还有人说移动会通过这条通道投放广告，劫持DNS等等，虽然真实性有待验证，但是删除它总归是没错的。\n![img1](/images/blog1img1.png)\n于是我就进入到了网络-网络连接-宽带设置界面，可以看到**1_TR069_R_VID_45**这条连接,但是它的**删除**按钮是灰色的，点了几下没反应。所以这条连接即便是超级用户也不能将其删除，与网友的说法有悖。一时无聊，点开了另一条连接。\n\n**悲剧就从此开始了。**\n\n凌晨3点多的我早已注意力涣散，双眼几乎失去焦点。只见这条连接的底下也有一个Delete，但并没有看清是否可点击。“要不点几下试试？”心中有一个大胆的想法，迟钝的大脑却没来得及阻止，手指已经摁下去了……\n![img2](/images/blog1img2.png)\n网页随即刷新，在页面消失之前我终于看见了一个关键词：**INTERNET**。\n手指一阵哆嗦，鸡皮疙瘩突然冒了出来！我好像……并不知道这条宽带的PPPoE密码！而开户人正在外地出差，家里老人要用这条宽带看电视。![img3](/images/blog1img3.jpg)\n于是乎，就这样闯下了大祸，接下来的几天都是用流量过日子的。\n\n**所以请读者们记住，移动光猫的后台在进行危险操作时是没有确认按钮的！！！**\n\n## 三、自救\n在断网的这一阵子，经过不断地学习，以及通过与同为移动用户的同学的交流~~献出PY~~而得到了以下干货，广西移动的朋友们可能用得上。\n### 广西移动宽带在线服务：\n[宽带密码重置](http://service.gx.10086.cn/operate/pwdRest.jsp)。或者凭短信验证码 or 服务密码直接修改：[宽带密码修改](http://service.gx.10086.cn/operate/pwd.jsp)。\n\n### 以下是新建PPPoE连接时的设置：\n* 封装类型：**PPPoE**；\n* 业务类型：选带有**INTERNET**或者**上网**字样的选项；\n* 连接模式：因为我手上暂时没有路由器，所以还是继续拿光猫当路由器，选**路由**；\n* IP模式：IPv4&IPv6或仅IPV4。据说由于大多数代理服务器不代理IPv6，所以访问支持IPv6的魔法网页时，浏览器会先尝试用IPv6连接，超时后再采用IPv4连接，这样反而导致了日常浏览网页的速度下降，按需抉择。\n* 用户名 and 密码填上去；\n* MTU：PPPoE最合适的值应设为1492。专业性的解释请看[这里](https://www.zhihu.com/question/54689598/answer/203006929)。\n* **启用Vlan请务必打勾，否则将拨号失败！**其中我所在地区的Vlan ID为66，供广西朋友参考；\n\tSSID端口绑定把第一个勾上，一般第一个指无线网络；\n\tLAN端口绑定：无论有没有接IPTV盒子，都把所有LAN口打勾，绑定互联网。移动的IPTV究竟是什么情况稍后说明；\n\t地址获取方式也选PPPoE；\n\t其他的保持默认即可。\n![img4](/images/blog1img4.png)\n\n### IPTV\n起初最担心的就是这个，因为我并不知道本地区移动IPTV的Vlan ID参数，也没有朋友使用移动的IPTV，并且羞于向宽带师傅求救。苦恼了几天，终于在偶然之间发现了移动的营销套路。\n移动前些年一直没拿到IPTV的营业牌照，而在竞争对手联通、电信都纷纷拿到牌照推出自己的IPTV盒子的情况下，移动则另辟蹊径，推出了不需要营业牌照的OTT盒子——“魔百盒”。\n* Q：OTT盒子是什么？和IPTV盒子有什么区别？\n\tA：OTT盒子又叫互联网盒子，举个例子，天猫盒子也是OTT盒子，特点是只要能联网就能用。而IPTV盒子和宽带一样，需要拨号才能使用。\n* Q:那既然如此，为什么要苦苦追求IPTV牌照，直接全上OTT盒子不就行了吗？\n\tA：OTT盒子虽然设置简单，但比起IPTV盒子有个致命的缺点，那就是占用带宽。OTT盒子依存于互联网，在看电视的时候，你的电脑不能随意满速下载，因为可能会影响到一旁在看电视的家人，反之同理。而IPTV的电视推流和网络是完全独立的，不会互相干涉影响。\n* 另外，IPTV优势在于直播延迟小，码率高，推流稳定；而OTT盒子优势在于有丰富的点播内容，还能看热门网剧。但移动也不是好欺负的，电视服务虽然免费送，但是很多热门资源都需要开通会员才能看。（你可能会赚，但移动永远不亏）\n\n而我的“IPTV”盒子正是移动的魔百盒，只要LAN口能上网即可。\n自此，这一场闹剧算是告一段落。\n\n## 四、发现\n在这几天的学习当中，我发现了一些奇技淫巧，供大家参考。\n### 删除TR069连接\nTR069连接是运营商的保留连接，方便远程管理光猫，甚至就连超级用户也没有情况删除，要想删除甚至要进shell。而有网友发现了一种投机取巧的方法可以在网页上直接删除TR069。\n具体操作：在TR069的页面右键，点击检查，出现如图页面。\n![img5](/images/blog1img5.png)\n我们再按组合键ctrl+F，搜索disabled，此时应该会出来很多个搜索结果。不要紧张，我们将鼠标悬停在搜索结果上逐个比对，当提示框出现在“**删除**”按钮上时，就说明这个就是我们的目标，如图所示。\n![img6](/images/blog1img6.png)\n接下来双击搜索目标，然后把整个\"disabled\"单词全部删除。你会惊奇的发现“**删除**”按钮已经变为可点击的状态了，此时直接点击**删除**就可以了。\n**此方法仅在广西移动HS8545M5上测试通过，不保证其他设备，以及后续固件可以使用！**\n\n### 在本地查看PPPoE密码\n**此方法在我的光猫的当前版本测试不通过，但在我朋友的光猫上测试通过，效果自测！**\n同样是通过审查元素的方式。打开PPPoE配置页面，我们把目光移到密码框那里。如果你的密码框里像我一样，里面是无数个圆点的话，那你可以放弃了；如果只有6个圆点的话，继续看下去。\n在密码框直接右键，点击检查。把高亮条目中的type=\"**password**\"改成type=\"**text**\"，点击空白处，密码就直接自己显示出来了。\n![img7](/images/blog1img7.png)\n~~不过既然有这功夫审查元素，为什么不直接去网上营业厅重置密码呢？~~\n\n### UPnP\n经朋友提醒发现，大部分光猫是默认关闭UPnP的，可到应用-UPnP配置页面启用。\n![img8](/images/blog1img8.png)\nUPnP主要是提高P2P相关连接的成功率。即使没有公网的移动宽带也可以打开，说不定大内网互联呢。\n\n## 五、后记\n本次对移动光猫的折腾就到此为止了。虽然没带来什么改变，但是依旧感觉收获甚多。\n顺便预告一下，下一次折腾可能就是半年后带着路由器回家，尝试改光猫桥接以及多拨了。据恩山的一位朋友表示，广西移动可以多拨，多拨效果是下行不叠加但是上行叠加了，看起来拿来做种不错。[帖子传送门](https://www.right.com.cn/forum/thread-4069529-1-1.html)\n也不知道上行叠加时的做种是怎么样的，难道是多个IP同时连接下载方？希望知道的朋友告诉我一下。\n\n<span style=\"font-size: 10px\">另外，感谢ikirby对本篇博文提供的帮助（</span>"}]